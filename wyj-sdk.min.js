var $wyj=function(t){"use strict";var r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=e(function(t,e){(function(t,e,n){var i=function(t,e,n){n=h.extend({},h.options,n);var r=h.runValidations(t,e,n);if(r.some(function(t){return h.isPromise(t.error)}))throw new Error("Use validate.async if you want support for promises");return i.processValidationResults(r,n)},h=i;h.extend=function(n){return[].slice.call(arguments,1).forEach(function(t){for(var e in t)n[e]=t[e]}),n},h.extend(i,{version:{major:0,minor:12,patch:0,metadata:null,toString:function(){var t=h.format("%{major}.%{minor}.%{patch}",h.version);return h.isEmpty(h.version.metadata)||(t+="+"+h.version.metadata),t}},Promise:"undefined"!=typeof Promise?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(t,e,n){var r,i,o,s,a,u,c,f=[];for(r in(h.isDomElement(t)||h.isJqueryElement(t))&&(t=h.collectFormValues(t)),e)for(i in o=h.getDeepObjectValue(t,r),s=h.result(e[r],o,t,r,n,e)){if(!(a=h.validators[i]))throw c=h.format("Unknown validator %{name}",{name:i}),new Error(c);u=s[i],(u=h.result(u,o,t,r,n,e))&&f.push({attribute:r,value:o,validator:i,globalOptions:n,attributes:t,options:u,error:a.call(a,o,u,r,t,n)})}return f},processValidationResults:function(t,e){t=h.pruneEmptyErrors(t,e),t=h.expandMultipleErrors(t,e),t=h.convertErrorMessages(t,e);var n=e.format||"grouped";if("function"!=typeof h.formatters[n])throw new Error(h.format("Unknown format %{format}",e));return t=h.formatters[n](t),h.isEmpty(t)?void 0:t},async:function(r,i,o){var s=(o=h.extend({},h.async.options,o)).wrapErrors||function(t){return t};!1!==o.cleanAttributes&&(r=h.cleanAttributes(r,i));var a=h.runValidations(r,i,o);return new h.Promise(function(e,n){h.waitForResults(a).then(function(){var t=h.processValidationResults(a,o);t?n(new s(t,o,r,i)):e(r)},function(t){n(t)})})},single:function(t,e,n){return n=h.extend({},h.single.options,n,{format:"flat",fullMessages:!1}),h({single:t},{single:e},n)},waitForResults:function(t){return t.reduce(function(t,e){return h.isPromise(e.error)?t.then(function(){return e.error.then(function(t){e.error=t||null})}):t},new h.Promise(function(t){t()}))},result:function(t){var e=[].slice.call(arguments,1);return"function"==typeof t&&(t=t.apply(null,e)),t},isNumber:function(t){return"number"==typeof t&&!isNaN(t)},isFunction:function(t){return"function"==typeof t},isInteger:function(t){return h.isNumber(t)&&t%1==0},isBoolean:function(t){return"boolean"==typeof t},isObject:function(t){return t===Object(t)},isDate:function(t){return t instanceof Date},isDefined:function(t){return null!=t},isPromise:function(t){return!!t&&h.isFunction(t.then)},isJqueryElement:function(t){return t&&h.isString(t.jquery)},isDomElement:function(t){return!!t&&(!(!t.querySelectorAll||!t.querySelector)&&(!(!h.isObject(document)||t!==document)||("object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName)))},isEmpty:function(t){var e;if(!h.isDefined(t))return!0;if(h.isFunction(t))return!1;if(h.isString(t))return h.EMPTY_STRING_REGEXP.test(t);if(h.isArray(t))return 0===t.length;if(h.isDate(t))return!1;if(h.isObject(t)){for(e in t)return!1;return!0}return!1},format:h.extend(function(t,r){return h.isString(t)?t.replace(h.format.FORMAT_REGEXP,function(t,e,n){return"%"===e?"%{"+n+"}":String(r[n])}):t},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(t){return h.isNumber(t)?100*t%1==0?""+t:parseFloat(Math.round(100*t)/100).toFixed(2):h.isArray(t)?t.map(function(t){return h.prettify(t)}).join(", "):h.isObject(t)?t.toString():(t=""+t).replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(t,e,n){return e+" "+n.toLowerCase()}).toLowerCase()},stringifyValue:function(t,e){return(e&&e.prettify||h.prettify)(t)},isString:function(t){return"string"==typeof t},isArray:function(t){return"[object Array]"==={}.toString.call(t)},isHash:function(t){return h.isObject(t)&&!h.isArray(t)&&!h.isFunction(t)},contains:function(t,e){return!!h.isDefined(t)&&(h.isArray(t)?-1!==t.indexOf(e):e in t)},unique:function(t){return h.isArray(t)?t.filter(function(t,e,n){return n.indexOf(t)==e}):t},forEachKeyInKeypath:function(t,e,n){if(h.isString(e)){var r,i="",o=!1;for(r=0;r<e.length;++r)switch(e[r]){case".":o?(o=!1,i+="."):(t=n(t,i,!1),i="");break;case"\\":o?(o=!1,i+="\\"):o=!0;break;default:o=!1,i+=e[r]}return n(t,i,!0)}},getDeepObjectValue:function(t,e){if(h.isObject(t))return h.forEachKeyInKeypath(t,e,function(t,e){if(h.isObject(t))return t[e]})},collectFormValues:function(t,e){var n,r,i,o,s,a,u={};if(h.isJqueryElement(t)&&(t=t[0]),!t)return u;for(e=e||{},o=t.querySelectorAll("input[name], textarea[name]"),n=0;n<o.length;++n)i=o.item(n),h.isDefined(i.getAttribute("data-ignored"))||(name=i.name.replace(/\./g,"\\\\."),a=h.sanitizeFormValue(i.value,e),"number"===i.type?a=a?+a:null:"checkbox"===i.type?i.attributes.value?i.checked||(a=u[name]||null):a=i.checked:"radio"===i.type&&(i.checked||(a=u[name]||null)),u[name]=a);for(o=t.querySelectorAll("select[name]"),n=0;n<o.length;++n)if(i=o.item(n),!h.isDefined(i.getAttribute("data-ignored"))){if(i.multiple)for(r in a=[],i.options)(s=i.options[r])&&s.selected&&a.push(h.sanitizeFormValue(s.value,e));else{var c=void 0!==i.options[i.selectedIndex]?i.options[i.selectedIndex].value:"";a=h.sanitizeFormValue(c,e)}u[i.name]=a}return u},sanitizeFormValue:function(t,e){return e.trim&&h.isString(t)&&(t=t.trim()),!1!==e.nullify&&""===t?null:t},capitalize:function(t){return h.isString(t)?t[0].toUpperCase()+t.slice(1):t},pruneEmptyErrors:function(t){return t.filter(function(t){return!h.isEmpty(t.error)})},expandMultipleErrors:function(t){var n=[];return t.forEach(function(e){h.isArray(e.error)?e.error.forEach(function(t){n.push(h.extend({},e,{error:t}))}):n.push(e)}),n},convertErrorMessages:function(t,n){var r=[],i=(n=n||{}).prettify||h.prettify;return t.forEach(function(t){var e=h.result(t.error,t.value,t.attribute,t.options,t.attributes,t.globalOptions);h.isString(e)?("^"===e[0]?e=e.slice(1):!1!==n.fullMessages&&(e=h.capitalize(i(t.attribute))+" "+e),e=e.replace(/\\\^/g,"^"),e=h.format(e,{value:h.stringifyValue(t.value,n)}),r.push(h.extend({},t,{error:e}))):r.push(t)}),r},groupErrorsByAttribute:function(t){var n={};return t.forEach(function(t){var e=n[t.attribute];e?e.push(t):n[t.attribute]=[t]}),n},flattenErrorsToArray:function(t){return t.map(function(t){return t.error}).filter(function(t,e,n){return n.indexOf(t)===e})},cleanAttributes:function(t,e){function r(t,e,n){return h.isObject(t[e])?t[e]:t[e]=!!n||{}}return h.isObject(e)&&h.isObject(t)?function t(e,n){if(!h.isObject(e))return e;var r,i,o=h.extend({},e);for(i in e)r=n[i],h.isObject(r)?o[i]=t(o[i],r):r||delete o[i];return o}(t,e=function(t){var e,n={};for(e in t)t[e]&&h.forEachKeyInKeypath(n,e,r);return n}(e)):{}},exposeModule:function(t,e,n,r,i){n?(r&&r.exports&&(n=r.exports=t),n.validate=t):(e.validate=t).isFunction(i)&&i.amd&&i([],function(){return t})},warn:function(t){"undefined"!=typeof console&&console.warn&&console.warn("[validate.js] "+t)},error:function(t){"undefined"!=typeof console&&console.error&&console.error("[validate.js] "+t)}}),i.validators={presence:function(t,e){if(!1!==(e=h.extend({},this.options,e)).allowEmpty?!h.isDefined(t):h.isEmpty(t))return e.message||this.message||"can't be blank"},length:function(t,e,n){if(h.isDefined(t)){var r,i=(e=h.extend({},this.options,e)).is,o=e.maximum,s=e.minimum,a=[],u=(t=(e.tokenizer||function(t){return t})(t)).length;return h.isNumber(u)?(h.isNumber(i)&&u!==i&&(r=e.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",a.push(h.format(r,{count:i}))),h.isNumber(s)&&u<s&&(r=e.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",a.push(h.format(r,{count:s}))),h.isNumber(o)&&o<u&&(r=e.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",a.push(h.format(r,{count:o}))),0<a.length?e.message||a:void 0):(h.error(h.format("Attribute %{attr} has a non numeric value for `length`",{attr:n})),e.message||this.notValid||"has an incorrect length")}},numericality:function(t,e,n,r,i){if(h.isDefined(t)){var o,s,a=[],u={greaterThan:function(t,e){return e<t},greaterThanOrEqualTo:function(t,e){return e<=t},equalTo:function(t,e){return t===e},lessThan:function(t,e){return t<e},lessThanOrEqualTo:function(t,e){return t<=e},divisibleBy:function(t,e){return t%e==0}},c=(e=h.extend({},this.options,e)).prettify||i&&i.prettify||h.prettify;if(h.isString(t)&&e.strict){var f="^-?(0|[1-9]\\d*)";if(e.onlyInteger||(f+="(\\.\\d+)?"),f+="$",!new RegExp(f).test(t))return e.message||e.notValid||this.notValid||this.message||"must be a valid number"}if(!0!==e.noStrings&&h.isString(t)&&!h.isEmpty(t)&&(t=+t),!h.isNumber(t))return e.message||e.notValid||this.notValid||this.message||"is not a number";if(e.onlyInteger&&!h.isInteger(t))return e.message||e.notInteger||this.notInteger||this.message||"must be an integer";for(o in u)if(s=e[o],h.isNumber(s)&&!u[o](t,s)){var l="not"+h.capitalize(o),p=e[l]||this[l]||this.message||"must be %{type} %{count}";a.push(h.format(p,{count:s,type:c(o)}))}return e.odd&&t%2!=1&&a.push(e.notOdd||this.notOdd||this.message||"must be odd"),e.even&&t%2!=0&&a.push(e.notEven||this.notEven||this.message||"must be even"),a.length?e.message||a:void 0}},datetime:h.extend(function(t,e){if(!h.isFunction(this.parse)||!h.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(h.isDefined(t)){var n,r=[],i=(e=h.extend({},this.options,e)).earliest?this.parse(e.earliest,e):NaN,o=e.latest?this.parse(e.latest,e):NaN;return t=this.parse(t,e),isNaN(t)||e.dateOnly&&t%864e5!=0?(n=e.notValid||e.message||this.notValid||"must be a valid date",h.format(n,{value:arguments[0]})):(!isNaN(i)&&t<i&&(n=e.tooEarly||e.message||this.tooEarly||"must be no earlier than %{date}",n=h.format(n,{value:this.format(t,e),date:this.format(i,e)}),r.push(n)),!isNaN(o)&&o<t&&(n=e.tooLate||e.message||this.tooLate||"must be no later than %{date}",n=h.format(n,{date:this.format(o,e),value:this.format(t,e)}),r.push(n)),r.length?h.unique(r):void 0)}},{parse:null,format:null}),date:function(t,e){return e=h.extend({},e,{dateOnly:!0}),h.validators.datetime.call(h.validators.datetime,t,e)},format:function(t,e){(h.isString(e)||e instanceof RegExp)&&(e={pattern:e});var n,r=(e=h.extend({},this.options,e)).message||this.message||"is invalid",i=e.pattern;if(h.isDefined(t))return h.isString(t)?(h.isString(i)&&(i=new RegExp(e.pattern,e.flags)),(n=i.exec(t))&&n[0].length==t.length?void 0:r):r},inclusion:function(t,e){if(h.isDefined(t)&&(h.isArray(e)&&(e={within:e}),e=h.extend({},this.options,e),!h.contains(e.within,t))){var n=e.message||this.message||"^%{value} is not included in the list";return h.format(n,{value:t})}},exclusion:function(t,e){if(h.isDefined(t)&&(h.isArray(e)&&(e={within:e}),e=h.extend({},this.options,e),h.contains(e.within,t))){var n=e.message||this.message||"^%{value} is restricted";return h.format(n,{value:t})}},email:h.extend(function(t,e){var n=(e=h.extend({},this.options,e)).message||this.message||"is not a valid email";if(h.isDefined(t))return h.isString(t)&&this.PATTERN.exec(t)?void 0:n},{PATTERN:/^[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z]{2,}$/i}),equality:function(t,e,n,r,i){if(h.isDefined(t)){h.isString(e)&&(e={attribute:e});var o=(e=h.extend({},this.options,e)).message||this.message||"is not equal to %{attribute}";if(h.isEmpty(e.attribute)||!h.isString(e.attribute))throw new Error("The attribute must be a non empty string");var s=h.getDeepObjectValue(r,e.attribute),a=e.comparator||function(t,e){return t===e},u=e.prettify||i&&i.prettify||h.prettify;return a(t,s,e,n,r)?void 0:h.format(o,{attribute:u(e.attribute)})}},url:function(t,e){if(h.isDefined(t)){var n=(e=h.extend({},this.options,e)).message||this.message||"is not a valid url",r=e.schemes||this.schemes||["http","https"],i=e.allowLocal||this.allowLocal||!1;if(!h.isString(t))return n;var o="^(?:(?:"+r.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",s="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";return i?s+="?":o+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",o+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+s+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",new RegExp(o,"i").exec(t)?void 0:n}}},i.formatters={detailed:function(t){return t},flat:h.flattenErrorsToArray,grouped:function(t){var e;for(e in t=h.groupErrorsByAttribute(t))t[e]=h.flattenErrorsToArray(t[e]);return t},constraint:function(t){var e;for(e in t=h.groupErrorsByAttribute(t))t[e]=t[e].map(function(t){return t.validator}).sort();return t}},i.exposeModule(i,this,t,e,n)}).call(r,e,t,null)}),i=(e(function(y){!function(t){if(t.__disableNativeFetch||!t.fetch){c.prototype.append=function(t,e){t=a(t),e=u(e);var n=this.map[t];n||(n=[],this.map[t]=n),n.push(e)},c.prototype.delete=function(t){delete this.map[a(t)]},c.prototype.get=function(t){var e=this.map[a(t)];return e?e[0]:null},c.prototype.getAll=function(t){return this.map[a(t)]||[]},c.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},c.prototype.set=function(t,e){this.map[a(t)]=[u(e)]},c.prototype.forEach=function(n,r){Object.getOwnPropertyNames(this.map).forEach(function(e){this.map[e].forEach(function(t){n.call(r,t,e,this)},this)},this)};var i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),n="FormData"in t,r="ArrayBuffer"in t,o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this)},p.call(h.prototype),p.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},m.error=function(){var t=new m(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];m.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new m(null,{status:e,headers:{location:t}})},t.Headers=c,t.Request=h,t.Response=m,t.fetch=function(n,r){return new Promise(function(o,s){var t;t=h.prototype.isPrototypeOf(n)&&!r?n:new h(n,r);var a=new XMLHttpRequest;var u=!1;function e(){if(4===a.readyState){var t=1223===a.status?204:a.status;if(t<100||599<t){if(u)return;return u=!0,void s(new TypeError("Network request failed"))}var e,i,n={status:t,statusText:a.statusText,headers:(e=a,i=new c,e.getAllResponseHeaders().trim().split("\n").forEach(function(t){var e=t.trim().split(":"),n=e.shift().trim(),r=e.join(":").trim();i.append(n,r)}),i),url:"responseURL"in a?a.responseURL:/^X-Request-URL:/m.test(a.getAllResponseHeaders())?a.getResponseHeader("X-Request-URL"):void 0},r="response"in a?a.response:a.responseText;u||(u=!0,o(new m(r,n)))}}a.onreadystatechange=e,a.onload=e,a.onerror=function(){u||(u=!0,s(new TypeError("Network request failed")))},a.open(t.method,t.url,!0);try{"include"===t.credentials&&("withCredentials"in a?a.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(t){console&&console.warn&&console.warn("set withCredentials error:"+t)}"responseType"in a&&i&&(a.responseType="blob"),t.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send(void 0===t._bodyInit?null:t._bodyInit)})},t.fetch.polyfill=!0,y.exports&&(y.exports=t.fetch)}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function c(e){this.map={},e instanceof c?e.forEach(function(t,e){this.append(e,t)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function l(n){return new Promise(function(t,e){n.onload=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function e(t){var e=new FileReader;return e.readAsArrayBuffer(t),l(e)}function p(){return this.bodyUsed=!1,this._initBody=function(t,e){if("string"==typeof(this._bodyInit=t))this._bodyText=t;else if(i&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t,this._options=e;else if(n&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!r||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText=""},this.text=i?(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(e)},function(){var t,e,n,r,i,o,s,a=f(this);if(a)return a;if(this._bodyBlob)return t=this._bodyBlob,e=this._options,n=new FileReader,r=e.headers.map["content-type"]?e.headers.map["content-type"].toString():"",i=/charset\=[0-9a-zA-Z\-\_]*;?/,o=t.type.match(i)||r.match(i),s=[t],o&&s.push(o[0].replace(/^charset\=/,"").replace(/;$/,"")),n.readAsText.apply(n,s),l(n);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):function(){var t=f(this);return t||Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(t,e){var n,r,i=(e=e||{}).body;if(h.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,i||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),-1<o.indexOf(r)?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i,e)}function d(t){var i=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),n=e.shift().replace(/\+/g," "),r=e.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(r))}}),i}function m(t,e){e||(e={}),this._initBody(t,e),this.type="default",this.status=e.status,this.ok=200<=this.status&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof c?e.headers:new c(e.headers),this.url=e.url||""}}("undefined"!=typeof self?self:r)}),e(function(t){var e,n;e=r,n=function(){var i=function(){},u="undefined",c=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function f(t,e){for(var n=0;n<c.length;n++){var r=c[n];this[r]=n<t?i:this.methodFactory(r,t,e)}this.log=this.debug}function l(t,e,n){return"debug"===(r=t)&&(r="log"),typeof console!==u&&(void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):i)||function(t,e,n){return function(){typeof console!==u&&(f.call(this,e,n),this[t].apply(this,arguments))}}.apply(this,arguments);var r}function n(n,t,e){var r,i=this,o="loglevel";function s(){var t;if(typeof window!==u){try{t=window.localStorage[o]}catch(t){}if(typeof t===u)try{var e=window.document.cookie,n=e.indexOf(encodeURIComponent(o)+"=");-1!==n&&(t=/^([^;]+)/.exec(e.slice(n))[1])}catch(t){}return void 0===i.levels[t]&&(t=void 0),t}}n&&(o+=":"+n),i.name=n,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=e||l,i.getLevel=function(){return r},i.setLevel=function(t,e){if("string"==typeof t&&void 0!==i.levels[t.toUpperCase()]&&(t=i.levels[t.toUpperCase()]),!("number"==typeof t&&0<=t&&t<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(r=t,!1!==e&&function(t){var e=(c[t]||"silent").toUpperCase();if(typeof window!==u){try{return window.localStorage[o]=e}catch(t){}try{window.document.cookie=encodeURIComponent(o)+"="+e+";"}catch(t){}}}(t),f.call(i,t,n),typeof console===u&&t<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(t){s()||i.setLevel(t,!1)},i.enableAll=function(t){i.setLevel(i.levels.TRACE,t)},i.disableAll=function(t){i.setLevel(i.levels.SILENT,t)};var a=s();null==a&&(a=null==t?"WARN":t),i.setLevel(a,!1)}var r=new n,s={};r.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=s[t];return e||(e=s[t]=new n(t,r.getLevel(),r.methodFactory)),e};var t=typeof window!==u?window.log:void 0;return r.noConflict=function(){return typeof window!==u&&window.log===r&&(window.log=t),r},r.getLoggers=function(){return s},r},t.exports?t.exports=n():e.log=n()})),s=Object.prototype.hasOwnProperty,o=a;function a(t,e,n){return 3===arguments.length?function(t,e,n){for(var r=Array.isArray(e)?e:e.split("."),i=0;i<r.length-1;i++){var o=r[i];a.p&&!s.call(t,o)&&(t[o]={}),t=t[o]}return t[r[i]]=n}.apply(null,arguments):function(t,e){for(var n=Array.isArray(e)?e:e.split("."),r=0;r<n.length;r++){var i=n[r];if(!t||!s.call(t,i)){t=void 0;break}t=t[i]}return t}.apply(null,arguments)}var u=e(function(t){(t.exports=function(){this.events={}}).prototype={emit:function(t){var e=[].slice.call(arguments,1);[].slice.call(this.events[t]||[]).filter(function(t){t.apply(this,e)})},on:function(t,e){if("production"!==process.env.NODE_ENV&&"function"!=typeof e)throw new Error("Listener must be a function");return(this.events[t]=this.events[t]||[]).push(e),function(){this.events[t]=this.events[t].filter(function(t){return t!==e})}.bind(this)}}});var c=function(t){t.events={}};function f(){}function l(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};e=e||f;var n=document.createElement("img");n.src=t,n.style.cssText="width: 0; height: 0;",n.addEventListener("error",function(){e({err:"加载失败"})}),n.addEventListener("load",function(){e()}),document.body.appendChild(n)}function p(t){var n={};return t&&t.split("&").forEach(function(t){var e=t.split("=");n[e.shift().trim()]=decodeURIComponent(e.join("="))}),n}var h=e(function(t,e){t.exports=function(){var s=function(t){return!(!(r=t)||"object"!=typeof r||(e=t,"[object RegExp]"===(n=Object.prototype.toString.call(e))||"[object Date]"===n||e.$$typeof===i));var e,n,r},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(t,e){return!1!==e.clone&&e.isMergeableObject(t)?o((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function u(t,e,n){return t.concat(e).map(function(t){return a(t,n)})}function c(e,n,r){var i={};return r.isMergeableObject(e)&&Object.keys(e).forEach(function(t){i[t]=a(e[t],r)}),Object.keys(n).forEach(function(t){r.isMergeableObject(n[t])&&e[t]?i[t]=function(t,e){if(!e.customMerge)return o;var n=e.customMerge(t);return"function"==typeof n?n:o}(t,r)(e[t],n[t],r):i[t]=a(n[t],r)}),i}function o(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||u,n.isMergeableObject=n.isMergeableObject||s;var r=Array.isArray(e),i=Array.isArray(t),o=r===i;return o?r?n.arrayMerge(t,e,n):c(t,e,n):a(e,n)}return o.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,e){return o(t,e,n)},{})},o}()}),d={baseURL:""},m=null,y=new Function("try {return this===window;}catch(e){ return false;}");function g(){this.list=[],this.errList=[]}function v(){}function b(t){var e;t=t||{};var n={};for(e in d)n[e]=t[e]||d[e];this._netConfig=n,this._defaults={headers:{"Content-Type":"application/json"},responseType:"json"},this.defaults={headers:{}},this.interceptors={request:new g,response:new g}}function w(t){var n,e,r,i;this._instance=new b({baseURL:t.url||""}),this._instance.defaults={headers:{identifier:t.id}},this.auth=(n=this._instance,{signin:function(t,e){return n.post("login",{body:{username:t,password:e}})},logout:function(){return n.delete("user")},signup:function(t){return n.post("register",{body:{username:t.username,password:t.password,sms_code:t.sms_code}})},reset:function(t){return n.post("reset",{body:{username:t.username,password:t.password,sms_code:t.sms_code}})},onekey:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return n.post("onekey",{body:{mac:t,auto_login:e}})},getUser:function(){return n.get("user")}}),this.config=(e=this._instance,{get:function(){return e.get("config")},getPayment:function(){return e.get("payment")},sms:function(t){return t.captcha_code||(t={mobile:t.mobile}),e.post("sms",{body:t})}}),this.user=(r=this._instance,{pay:function(t){return r.post("user/transaction",{body:t})},getTransaction:function(t){return r.get("user/transaction/"+t)},checkMac:function(){return r.get("user/mac")},changeMac:function(t){return r.post("user/mac",{body:t})},trial:function(){return r.post("user/trial")}}),this.vendor=(i=this._instance,{getPassParams:function(t){return i.get("user/pass",{params:t})}})}m=y()?fetch:require("node-fetch"),g.prototype.add=function(t,e){e=e||v,this.list.push(t),this.errList.push(e)},b.fetch=b.prototype.fetch=function(t,e){var n,r=this,i=this._netConfig.baseURL||"",o=h.all([this._defaults,this.defaults,e]);return o.body&&"application/json"===(n=o).headers["Content-Type"]&&(n.body=JSON.stringify(n.body)),o.params&&(t+=function(t){var e,n="?";for(e in t.params)n+=e+"="+String(t.params[e])+"&";return n=n.slice(0,n.length-1),delete t.params,n}(o)),m(i+t,o).then(function(t){try{return t.ok&&200===t.status?"json"===o.responseType?t.json():t.text():t.json().then(function(e){if(!r.interceptors)throw e;throw r.interceptors.response.errList.forEach(function(t){t(e)}),e})}catch(t){throw t}})},b.prototype.get=function(t,e){},b.prototype.post=function(t,e){},b.prototype.put=function(t,e){},b.prototype.delete=function(t,e){},["GET","POST","DELETE","PUT"].forEach(function(i){b.prototype[i.toLowerCase()]=function(t,e){var n,r={method:i};for(n in e)"method"!==n&&(r[n]=e[n]);return this.fetch(t,r)}}),w.prototype.setToken=function(t){this._instance.defaults.headers.Authorization=t},w.prototype.removeToken=function(){this._instance.defaults.headers.Authorization="",delete this._instance.defaults.headers.Authorization};var E={auth:function(e){return new Promise(function(t){l(e.url,function(){t()})})}},_={auth:function(e){return new Promise(function(t){l(e.url,function(){t()})})}},T=new b,x={bithighway:E,ikuai:_,panabit:{auth:function(i){return new Promise(function(){var t=location.href.split("?"),e=t[0],n=p(t[1]);delete n.redirect;var r=Object.entries(n).reduce(function(t,e){return t+e[0]+"="+e[1]+"&"},"?");r=r.slice(0,r.length-1),location.href=i.url+"&redirect="+e+encodeURIComponent(r)})},produce:function(t,e){if(t&&t.auth_url)return{auth_url:t.auth_url}}},http:{auth:function(n){return new Promise(function(t,e){T.post(n.url,{headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"text",body:n.params}).then(function(){t()}).catch(function(){e()})})}},gocloud:{auth:function(e){return new Promise(function(t){l(e.url,function(){t()})})},produce:function(t,e){if(e&&e.submitUrl)return{submitUrl:e.submitUrl}}},mikrotik:{auth:function(i){return new Promise(function(){var t=location.href.split("?"),e=t[0],n=p(t[1]);delete n.redirect;var r=Object.entries(n).reduce(function(t,e){return t+e[0]+"="+e[1]+"&"},"?");r=r.slice(0,r.length-1),location.href=i.url+"&redirect="+e+encodeURIComponent(r)})},produce:function(t,e){if(t&&t.auth_url)return{auth_url:t.auth_url}}}};function A(n){return new Promise(function(t,e){!function e(n,r){r.checkTime--;var t=Date.now();l("https://weiyunjian-check-1251304829.picsh.myqcloud.com/"+t+".jpg",function(t){if(t){if(r.checkTime<1)return n.reject();clearTimeout(r.timer),r.timer=setTimeout(function(){e(n,r)},1e3)}else n.resolve()})}({resolve:t,reject:e},{checkTime:n,timer:null})})}function O(t,e){var n=t.keys,r=e[n.ip],i=e[n.mac],o={ip:r,mac:i};if(r&&i)return o;var s=j[t.name],a=s&&s(t,e);return a&&(o=a),o}var j={ikuai:function(t,e){if(!e.ikenc)return;var n=p(atob(e.ikenc)),r=t.keys;return{ip:n[r.ip],mac:n[r.mac]}},gocloud:function(t,e){if(!e.gcenv)return;var n=p(atob(e.gcenv));return{ip:n.usrip,mac:n.usrmac,extra:{submitUrl:n.submitUrl}}}};var R=new Error("Need portal id.");function k(t){if(this.status="init",this.deviceType=function(){try{if(!navigator)return"server"}catch(t){return"server"}var t=navigator.userAgent||navigator.vendor||window.opera;return/micromessenger/i.test(t.toLowerCase())?"wechat":/ipad|iphone os|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile/i.test(t)?"mobile":"pc"}(),this.__VERSION__="0.0.1",this._data={},this._config=t,this._events=new u,this._api=new w({url:t.api_url,id:t.id}),this.vendors=x,this.auth={vendors:x,check:A,clientInfo:O},this.net=this._api._instance,!t||!t.id)throw R;t.debug?i.setLevel(i.levels.DEBUG):i.setLevel(i.levels.ERROR),this._bootstrap()}return k.auth={vendors:x,check:A,clientInfo:O},k.prototype.validate=function(){return!0},k.prototype.on=function(t,e){t===this.status?e():this._events.on(t,e)},k.prototype.destroy=function(){"destroyed"!==this.status&&(this._events.emit("destroyed"),this._unbindEvents(),this.status="destroyed")},k.prototype.get=function(t){var e=o(this._data,t);return i.debug("get: "+t+", result: "+e),e},k.prototype.set=function(t,e){var n=o(this._data,t,e);return i.debug("set: "+t+", result: ",n),n},k.prototype.signin=function(t,e){var n=this;return this._api.auth.signin(t,e).then(function(t){return n._api.setToken(t.data.token),n.set("user",t.data)})},k.prototype.onekey=function(t,e){var n=this;return this._api.auth.onekey(t,e).then(function(t){if(!t.data||!t.data.token)throw new Error("Auto one key error");return n._api.setToken(t.data.token),n.set("user",t.data)})},k.prototype.checkAuth=function(t){var e=this;return this._api.setToken(t),this._api.auth.getUser().then(function(t){return e.set("user",t.data)}).catch(function(t){throw e._api.removeToken(),t})},k.prototype.logout=function(){var t=this;return this._api.auth.logout().then(function(){t._api.removeToken()}).catch(function(){t._api.removeToken()})},k.prototype.signup=function(t){var e=this;return this._api.auth.signup(t).then(function(t){return e._api.setToken(t.data.token),e.set("user",t.data)})},k.prototype.reset=function(t){return this._api.auth.reset(t)},k.prototype.fetchConfig=function(){return this._api.config.get().then(function(t){return t.data})},k.prototype.fetchPayment=function(){var e=this;return this._api.config.getPayment().then(function(t){return e.set("packages",t.packages),e.set("payments",t.methods),t})},k.prototype.pay=function(t){return this._api.user.pay(t)},k.prototype.getTransaction=function(t){return this._api.user.getTransaction(t)},k.prototype.getPassParams=function(t){return this._api.vendor.getPassParams(t)},k.prototype.sms=function(t){return this._api.config.sms(t)},k.prototype.checkMac=function(){return this._api.user.checkMac()},k.prototype.changeMac=function(t){return this._api.user.changeMac(t)},k.prototype.trial=function(){return this._api.user.trial()},k.prototype._bootstrap=function(){this.status="bootstrap",this._events.emit("bootstrap")},k.prototype._unbindEvents=function(){c(this._events)},i.setDefaultLevel(i.levels.INFO),k.prototype.validate=n,t.Portal=k,t.default=k,t}({});
